\hypertarget{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ArgMaxImpl}{}\section{Inference\+Engine\+:\+:Extensions\+:\+:Cpu\+:\+:Arg\+Max\+Impl Class Reference}
\label{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ArgMaxImpl}\index{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl@{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl}}


Inheritance diagram for Inference\+Engine\+:\+:Extensions\+:\+:Cpu\+:\+:Arg\+Max\+Impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=222pt]{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ArgMaxImpl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Inference\+Engine\+:\+:Extensions\+:\+:Cpu\+:\+:Arg\+Max\+Impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=234pt]{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ArgMaxImpl__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ArgMaxImpl_a9344fd147a948eab35731fbbb69d2e99}{Arg\+Max\+Impl} (const C\+N\+N\+Layer $\ast$layer)
\item 
Status\+Code \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ArgMaxImpl_a4acb850c8f11dd20040cb02ffe6222da}{execute} (std\+::vector$<$ Blob\+::\+Ptr $>$ \&inputs, std\+::vector$<$ Blob\+::\+Ptr $>$ \&outputs, Response\+Desc $\ast$resp) noexceptoverride
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 31 of file ext\+\_\+argmax.\+cpp.



\subsection{Constructor \& Destructor Documentation}
\index{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl@{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl}!Arg\+Max\+Impl@{Arg\+Max\+Impl}}
\index{Arg\+Max\+Impl@{Arg\+Max\+Impl}!Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl@{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl}}
\subsubsection[{\texorpdfstring{Arg\+Max\+Impl(const C\+N\+N\+Layer $\ast$layer)}{ArgMaxImpl(const CNNLayer *layer)}}]{\setlength{\rightskip}{0pt plus 5cm}Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl\+::\+Arg\+Max\+Impl (
\begin{DoxyParamCaption}
\item[{const C\+N\+N\+Layer $\ast$}]{layer}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}\hypertarget{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ArgMaxImpl_a9344fd147a948eab35731fbbb69d2e99}{}\label{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ArgMaxImpl_a9344fd147a948eab35731fbbb69d2e99}


Definition at line 33 of file ext\+\_\+argmax.\+cpp.


\begin{DoxyCode}
33                                               : \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_affff0e8263ca26852ccf71d299d7b06a}{ExtLayerBase}(layer) \{
34         \textcolor{keywordflow}{try} \{
35             \textcolor{keywordflow}{if} (\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.insData.size() != 1 || \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.outData.empty())
36                 THROW\_IE\_EXCEPTION << \textcolor{stringliteral}{"Incorrect number of input/output edges!"};
37 
38             out\_max\_val\_ = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{bool}\textcolor{keyword}{>}(\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.GetParamAsInt(\textcolor{stringliteral}{"out\_max\_val"}));
39             top\_k\_       = \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.GetParamAsInt(\textcolor{stringliteral}{"top\_k"});
40 
41             has\_axis\_ = (\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.params.find(\textcolor{stringliteral}{"axis"}) != \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.params.end());
42             axis\_index\_ = has\_axis\_ ?
43                                 std::stoi(\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.params[\textcolor{stringliteral}{"axis"}]) :0;
44 
45             \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a0ac7a6632e95b9500d5246b05b4b0bfa}{addConfig}(\{DataConfigurator(\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1258a8d209e0249e0b1717618352ddfba446687ea2db1ada75be5ed053be77f59}{ConfLayout::PLN})\}, \{DataConfigurator(
      \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1258a8d209e0249e0b1717618352ddfba446687ea2db1ada75be5ed053be77f59}{ConfLayout::PLN})\});
46         \} \textcolor{keywordflow}{catch} (InferenceEngine::details::InferenceEngineException &ex) \{
47             \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_abc78e9b5a79fa339ffd831a5318f71f7}{errorMsg} = ex.what();
48         \}
49     \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl@{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl}!execute@{execute}}
\index{execute@{execute}!Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl@{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl}}
\subsubsection[{\texorpdfstring{execute(std\+::vector$<$ Blob\+::\+Ptr $>$ \&inputs, std\+::vector$<$ Blob\+::\+Ptr $>$ \&outputs, Response\+Desc $\ast$resp) noexceptoverride}{execute(std::vector< Blob::Ptr > &inputs, std::vector< Blob::Ptr > &outputs, ResponseDesc *resp) noexceptoverride}}]{\setlength{\rightskip}{0pt plus 5cm}Status\+Code Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+Arg\+Max\+Impl\+::execute (
\begin{DoxyParamCaption}
\item[{std\+::vector$<$ Blob\+::\+Ptr $>$ \&}]{inputs, }
\item[{std\+::vector$<$ Blob\+::\+Ptr $>$ \&}]{outputs, }
\item[{Response\+Desc $\ast$}]{resp}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [noexcept]}}\hypertarget{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ArgMaxImpl_a4acb850c8f11dd20040cb02ffe6222da}{}\label{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ArgMaxImpl_a4acb850c8f11dd20040cb02ffe6222da}


Definition at line 51 of file ext\+\_\+argmax.\+cpp.


\begin{DoxyCode}
52                                                              \{
53         SizeVector in\_dims = inputs[0]->getTensorDesc().getDims();
54         SizeVector out\_dims = outputs[0]->getTensorDesc().getDims();
55 
56         \textcolor{keywordtype}{int} dim, axis\_dist;
57         \textcolor{keywordflow}{if} (has\_axis\_) \{
58             \textcolor{keywordtype}{int} axis\_ = (axis\_index\_ < 0) ? axis\_index\_ + static\_cast<int>(in\_dims.size()) : axis\_index\_;
59             dim = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(inputs[0]->getTensorDesc().getDims()[axis\_]);
60             axis\_dist = count(inputs[0]->getTensorDesc().getDims(), axis\_) / dim;
61         \} \textcolor{keywordflow}{else} \{
62             dim = count(inputs[0]->getTensorDesc().getDims(), 1);
63             axis\_dist = 1;
64         \}
65 
66         \textcolor{keywordtype}{float}* src\_data = inputs[0]->buffer();
67         \textcolor{keywordtype}{float}* dst\_data = outputs[0]->buffer();
68 
69         \textcolor{keywordtype}{int} num = count(in\_dims) / dim;
70         std::vector<std::pair<float, int> > src\_vector(dim);
71 
72         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < num; ++i) \{
73             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dim; ++j) \{
74                 src\_vector[j] = std::make\_pair(
75                         src\_data[(i / axis\_dist * dim + j) * axis\_dist + i % axis\_dist], j);
76             \}
77 
78             std::partial\_sort(src\_vector.begin(), src\_vector.begin() + top\_k\_,
79                               src\_vector.end(), std::greater<std::pair<float, int> >());
80 
81             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < top\_k\_; ++j) \{
82                 \textcolor{keywordflow}{if} (out\_max\_val\_) \{
83                     \textcolor{keywordflow}{if} (has\_axis\_) \{
84                         \textcolor{comment}{// Produces max\_val per axis}
85                         dst\_data[(i / axis\_dist * top\_k\_ + j) * axis\_dist + i % axis\_dist] = src\_vector[j].
      first;
86                     \} \textcolor{keywordflow}{else} \{
87                         \textcolor{comment}{// Produces max\_ind and max\_val}
88                         dst\_data[2 * i * top\_k\_ + j] = src\_vector[j].second;
89                         dst\_data[2 * i * top\_k\_ + top\_k\_ + j] = src\_vector[j].first;
90                     \}
91                 \} \textcolor{keywordflow}{else} \{
92                     \textcolor{comment}{// Produces max\_ind per axis}
93                     dst\_data[(i / axis\_dist * top\_k\_ + j) * axis\_dist + i % axis\_dist] = src\_vector[j].
      second;
94                 \}
95             \}
96         \}
97 
98         \textcolor{keywordflow}{return} OK;
99     \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
thirdparty/extension/\hyperlink{ext__argmax_8cpp}{ext\+\_\+argmax.\+cpp}\end{DoxyCompactItemize}
