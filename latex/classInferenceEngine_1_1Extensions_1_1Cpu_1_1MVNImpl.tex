\hypertarget{classInferenceEngine_1_1Extensions_1_1Cpu_1_1MVNImpl}{}\section{Inference\+Engine\+:\+:Extensions\+:\+:Cpu\+:\+:M\+V\+N\+Impl Class Reference}
\label{classInferenceEngine_1_1Extensions_1_1Cpu_1_1MVNImpl}\index{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl@{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl}}


Inheritance diagram for Inference\+Engine\+:\+:Extensions\+:\+:Cpu\+:\+:M\+V\+N\+Impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=222pt]{classInferenceEngine_1_1Extensions_1_1Cpu_1_1MVNImpl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Inference\+Engine\+:\+:Extensions\+:\+:Cpu\+:\+:M\+V\+N\+Impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=234pt]{classInferenceEngine_1_1Extensions_1_1Cpu_1_1MVNImpl__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1MVNImpl_afbbb54c029bcfa2bfd204d55963438f0}{M\+V\+N\+Impl} (const C\+N\+N\+Layer $\ast$layer)
\item 
Status\+Code \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1MVNImpl_a654c2e29f3c9ce1e2c984de928a0441a}{execute} (std\+::vector$<$ Blob\+::\+Ptr $>$ \&inputs, std\+::vector$<$ Blob\+::\+Ptr $>$ \&outputs, Response\+Desc $\ast$resp) noexceptoverride
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 28 of file ext\+\_\+mvn.\+cpp.



\subsection{Constructor \& Destructor Documentation}
\index{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl@{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl}!M\+V\+N\+Impl@{M\+V\+N\+Impl}}
\index{M\+V\+N\+Impl@{M\+V\+N\+Impl}!Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl@{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl}}
\subsubsection[{\texorpdfstring{M\+V\+N\+Impl(const C\+N\+N\+Layer $\ast$layer)}{MVNImpl(const CNNLayer *layer)}}]{\setlength{\rightskip}{0pt plus 5cm}Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl\+::\+M\+V\+N\+Impl (
\begin{DoxyParamCaption}
\item[{const C\+N\+N\+Layer $\ast$}]{layer}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}\hypertarget{classInferenceEngine_1_1Extensions_1_1Cpu_1_1MVNImpl_afbbb54c029bcfa2bfd204d55963438f0}{}\label{classInferenceEngine_1_1Extensions_1_1Cpu_1_1MVNImpl_afbbb54c029bcfa2bfd204d55963438f0}


Definition at line 30 of file ext\+\_\+mvn.\+cpp.


\begin{DoxyCode}
30                                            : \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_affff0e8263ca26852ccf71d299d7b06a}{ExtLayerBase}(layer) \{
31         \textcolor{keywordflow}{try} \{
32             \textcolor{keywordflow}{if} (\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.insData.size() != 1 || \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.outData.empty())
33                 THROW\_IE\_EXCEPTION << \textcolor{stringliteral}{"Incorrect number of input/output edges!"};
34 
35             across\_channels = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{bool}\textcolor{keyword}{>}(\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.GetParamAsInt(\textcolor{stringliteral}{"across\_channels"}));
36             normalize\_variance = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{bool}\textcolor{keyword}{>}(\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.GetParamAsInt(\textcolor{stringliteral}{"normalize\_variance"}));
37             eps = \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1074cdccacb9e9ca6eec01bbc2f7ca4a}{cnnLayer}.GetParamAsFloat(\textcolor{stringliteral}{"eps"});
38 
39             \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a0ac7a6632e95b9500d5246b05b4b0bfa}{addConfig}(\{\{\hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1258a8d209e0249e0b1717618352ddfba446687ea2db1ada75be5ed053be77f59}{ConfLayout::PLN}, \textcolor{keyword}{false}, 0\}\}, \{\{
      \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_a1258a8d209e0249e0b1717618352ddfba446687ea2db1ada75be5ed053be77f59}{ConfLayout::PLN}, \textcolor{keyword}{false}, 0\}\});
40         \} \textcolor{keywordflow}{catch} (InferenceEngine::details::InferenceEngineException &ex) \{
41             \hyperlink{classInferenceEngine_1_1Extensions_1_1Cpu_1_1ExtLayerBase_abc78e9b5a79fa339ffd831a5318f71f7}{errorMsg} = ex.what();
42         \}
43     \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl@{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl}!execute@{execute}}
\index{execute@{execute}!Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl@{Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl}}
\subsubsection[{\texorpdfstring{execute(std\+::vector$<$ Blob\+::\+Ptr $>$ \&inputs, std\+::vector$<$ Blob\+::\+Ptr $>$ \&outputs, Response\+Desc $\ast$resp) noexceptoverride}{execute(std::vector< Blob::Ptr > &inputs, std::vector< Blob::Ptr > &outputs, ResponseDesc *resp) noexceptoverride}}]{\setlength{\rightskip}{0pt plus 5cm}Status\+Code Inference\+Engine\+::\+Extensions\+::\+Cpu\+::\+M\+V\+N\+Impl\+::execute (
\begin{DoxyParamCaption}
\item[{std\+::vector$<$ Blob\+::\+Ptr $>$ \&}]{inputs, }
\item[{std\+::vector$<$ Blob\+::\+Ptr $>$ \&}]{outputs, }
\item[{Response\+Desc $\ast$}]{resp}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [noexcept]}}\hypertarget{classInferenceEngine_1_1Extensions_1_1Cpu_1_1MVNImpl_a654c2e29f3c9ce1e2c984de928a0441a}{}\label{classInferenceEngine_1_1Extensions_1_1Cpu_1_1MVNImpl_a654c2e29f3c9ce1e2c984de928a0441a}


Definition at line 45 of file ext\+\_\+mvn.\+cpp.


\begin{DoxyCode}
46                                                              \{
47         \textcolor{keywordtype}{float}* src\_data = inputs[0]->buffer();
48         \textcolor{keywordtype}{float}* dst\_data = outputs[0]->buffer();
49 
50         SizeVector dims = inputs[0]->getTensorDesc().getDims();
51 
52         \textcolor{keywordtype}{int} N = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((dims.size() > 0) ? dims[0] : 1);
53         \textcolor{keywordtype}{int} C = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((dims.size() > 1) ? dims[1] : 1);
54         \textcolor{keywordtype}{int} H = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((dims.size() > 2) ? dims[2] : 1);
55         \textcolor{keywordtype}{int} W = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}((dims.size() > 3) ? dims[3] : 1);
56 
57         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} b = 0; b < N; b++) \{
58             \textcolor{comment}{// Calculate mean value}
59             \textcolor{keywordflow}{if} (across\_channels) \{
60                 \textcolor{keywordtype}{double} mean = 0;
61 \textcolor{preprocessor}{                #pragma omp parallel for reduction(+ : mean) schedule(static)}
62                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} = 0; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} < C; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}++) \{
63                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} h = 0; h < H; h++) \{
64                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} w = 0; w < W; w++) \{
65                             mean += src\_data[b*C*H*W + \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}*H*W + h*W + w];
66                         \}
67                     \}
68                 \}
69                 mean /= C*H*W;
70 \textcolor{preprocessor}{                #pragma omp parallel for schedule(static)}
71                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} = 0; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} < C; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}++) \{
72                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} h = 0; h < H; h++) \{
73                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} w = 0; w < W; w++) \{
74                             dst\_data[b*C*H*W + \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}*H*W + h*W + w] = src\_data[b*C*H*W + 
      \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}*H*W + h*W + w] - mean;
75                         \}
76                     \}
77                 \}
78             \} \textcolor{keywordflow}{else} \{
79 \textcolor{preprocessor}{                #pragma omp parallel for schedule(static)}
80                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} = 0; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} < C; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}++) \{
81                     \textcolor{keywordtype}{double} mean = 0;
82                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} h = 0; h < H; h++) \{
83                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} w = 0; w < W; w++) \{
84                             mean += src\_data[b*C*H*W + \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}*H*W + h*W + w];
85                         \}
86                     \}
87                     mean /= H*W;
88 
89                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} h = 0; h < H; h++) \{
90                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} w = 0; w < W; w++) \{
91                             dst\_data[b*C*H*W + \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}*H*W + h*W + w] = src\_data[b*C*H*W + 
      \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}*H*W + h*W + w] - mean;
92                         \}
93                     \}
94                 \}
95             \}
96         \}
97 
98         \textcolor{keywordflow}{if} (normalize\_variance) \{
99             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} b = 0; b < N; b++) \{
100                 \textcolor{comment}{// Calculate variances value}
101                 \textcolor{keywordflow}{if} (across\_channels) \{
102                     \textcolor{keywordtype}{double} variance = 0;
103 \textcolor{preprocessor}{                    #pragma omp parallel for reduction(+ : variance) schedule(static)}
104                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} = 0; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} < C; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}++) \{
105                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} h = 0; h < H; h++) \{
106                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} w = 0; w < W; w++) \{
107                                 variance += std::pow(dst\_data[b*C*H*W + \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}*H*W + h*W + w], 2);
108                             \}
109                         \}
110                     \}
111                     variance /= C*H*W;
112                     variance = std::pow(variance, 0.5f);
113                     variance += eps;
114 \textcolor{preprocessor}{                    #pragma omp parallel for schedule(static)}
115                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} = 0; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} < C; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}++) \{
116                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} h = 0; h < H; h++) \{
117                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} w = 0; w < W; w++) \{
118                                 dst\_data[b*C*H*W + \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}*H*W + h*W + w] /= variance;
119                             \}
120                         \}
121                     \}
122                 \} \textcolor{keywordflow}{else} \{
123 \textcolor{preprocessor}{                    #pragma omp parallel for schedule(static)}
124                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} = 0; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c} < C; \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}++) \{
125                         \textcolor{keywordtype}{double} variance = 0;
126                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} h = 0; h < H; h++) \{
127                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} w = 0; w < W; w++) \{
128                                 variance += std::pow(dst\_data[b*C*H*W + \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}*H*W + h*W + w], 2);
129                             \}
130                         \}
131                         variance /= H*W;
132                         variance = std::pow(variance, 0.5f);
133                         variance += eps;
134                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} h = 0; h < H; h++) \{
135                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} w = 0; w < W; w++) \{
136                                 dst\_data[b*C*H*W + \hyperlink{CMakeCache_8txt_aac1d6a1710812201527c735f7c6afbaa}{c}*H*W + h*W + w] /= variance;
137                             \}
138                         \}
139                     \}
140                 \}
141             \}
142         \}
143         \textcolor{keywordflow}{return} OK;
144     \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
thirdparty/extension/\hyperlink{ext__mvn_8cpp}{ext\+\_\+mvn.\+cpp}\end{DoxyCompactItemize}
